<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta itemprop="name" content="Strains">
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
        integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.26.1/axios.min.js"
        integrity="sha512-bPh3uwgU5qEMipS/VOmRqynnMXGGSRv+72H/N260MQeXZIK4PG48401Bsby9Nq5P5fz7hy5UGNmC/W1Z51h2GQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
    </style>
    <script>
        function makePostRequest() {
            const ele = document.getElementById('ontology-term')
            axios
                .post('http://127.0.0.1:5000/request', { id: ele.value })
                .then((resp) => {
                    const codeblock = document.getElementById('markdown-result');
                    const mermaidblock = document.getElementById('mermaid');

                    codeblock.textContent = resp.data.mermaid_text;
                    const textArray = resp.data.mermaid_text.split(/\r?\n/)
                    const mermaidOnlyText = textArray.slice(1,textArray.length-2).join("\n")
                    mermaidblock.textContent = mermaidOnlyText;
                    mermaidblock.removeAttribute('data-processed')
                    mermaid.init(undefined)
                })
        }
        function copyText() {
            const codeblock = document.getElementById('markdown-result');
            navigator.clipboard.writeText(codeblock.textContent).then(() => {
                alert("successfully copied");
            })
                .catch(() => {
                    alert("something went wrong");
                });

        }
    </script>

</head>

<body>
    <div class="container mx-auto col-6">
        <h1>Ontology map creator</h1>

        <div class="form-group">
            <label for="ontology-url">Ontology-url - select from the list</label>
            <select class="form-select" aria-label="Default select example" id="ontology-url">
                <option selected value="">Open this select menu</option>
                <option value="https://github.com/pombase/fypo/raw/master/fypo-base.obo">FYPO-last</option>
                <option value="https://github.com/geneontology/go-ontology/raw/master/src/ontology/go-edit.obo">GO-last</option>
              </select>

            <label for="ontology-url">Ontology url - write your URL</label>
            <input type="text" class="form-control m-2" id="ontology-url" value="https://github.com/pombase/fypo/raw/master/fypo-base.obo">

            <label for="ontology-term  m-2">Term ID</label>
            <input type="text" class="form-control m-2" id="ontology-term" value="FYPO:0000276">

        </div>
        <button type="submit" class="btn btn-primary m-2" onclick="makePostRequest()">Submit</button>
        <pre><code id="markdown-result" onclick="copyText()">
        </code></pre>
        <div class="mermaid" id="mermaid">

        </div>
    </div>

</body>

</html>